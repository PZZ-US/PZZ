<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz - {{ category_name }} | Sfera Inżyniera</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'styles/main.css' %}">
</head>

<body>
    {% include "header.html" %}
    <section class="active-quiz-section">
        <div class="wrapper">
            <h1>{{ category_name }}</h1>
            <p>PROGRES:</p>
            <div class="progress-container">
                <div class="progress-bar" style="width: {{ progress }}%;">
                    <p>{{ progress }}/10 pytań</p>
                </div>
            </div>
            <div class="section-container">

                <div class="question">
                    <h2>{{ quiz_questions.0.question }}</h2>
                    <ul>
                        {% for choice in quiz_questions.0.choices %}
                            <li class="answer" onclick="selectAnswer(this)">{{ choice }}</li>
                        {% endfor %}
                    </ul>
                </div>

            </div>
            <div class="button-section">
                <div onclick="showNextQuestion()" class="next-button">Następne pytanie</div>
            </div>
        </div>
    </section>
    {% include "footer.html" %}

    <script>
        var currentQuestion = 0;

        function showNextQuestion() {
            var questions = {{ quiz_questions|safe }};
            currentQuestion++;

            if (currentQuestion < questions.length) {
                var question = questions[currentQuestion];
                document.querySelector('.question h2').innerText = question.question;
                var choicesList = document.querySelector('.question ul');
                choicesList.innerHTML = "";

                question.choices.forEach(function (choice) {
                    var li = document.createElement('li');
                    li.className = 'answer';
                    li.innerText = choice;
                    li.onclick = function () { selectAnswer(this); };
                    choicesList.appendChild(li);
                });
            } else {
                //przekierowanie po ostatnim pytaniu
                window.location.href = '/my-result';
            }
        }

        function selectAnswer(selectedElement) {
            document.querySelectorAll('.answer').forEach(function (answer) {
                answer.classList.remove('active');
            });

            selectedElement.classList.add('active');
        }
    </script>

</body>

</html>
